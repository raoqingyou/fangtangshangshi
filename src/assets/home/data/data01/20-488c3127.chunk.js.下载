(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"./src/pages/EnterpriseFinancingProduct/Modal/InsuranceApplyModal/index.js":function(e,t,a){"use strict";var l=a("./node_modules/@babel/runtime/helpers/interopRequireWildcard.js"),n=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("./node_modules/antd/es/tooltip/style/css.js");var r=n(a("./node_modules/antd/es/tooltip/index.js"));a("./node_modules/antd/es/checkbox/style/css.js");var u=n(a("./node_modules/antd/es/checkbox/index.js"));a("./node_modules/antd/es/row/style/css.js");var i=n(a("./node_modules/antd/es/row/index.js"));a("./node_modules/antd/es/col/style/css.js");var s=n(a("./node_modules/antd/es/col/index.js")),d=n(a("./node_modules/@babel/runtime/helpers/construct.js")),o=n(a("./node_modules/@babel/runtime/helpers/defineProperty.js"));a("./node_modules/antd/es/message/style/css.js");var c=n(a("./node_modules/antd/es/message/index.js")),p=n(a("./node_modules/@babel/runtime/helpers/classCallCheck.js")),m=n(a("./node_modules/@babel/runtime/helpers/createClass.js")),f=n(a("./node_modules/@babel/runtime/helpers/inherits.js")),g=n(a("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),h=n(a("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));a("./node_modules/antd/es/modal/style/css.js");var b=n(a("./node_modules/antd/es/modal/index.js"));a("./node_modules/antd/es/input/style/css.js");var E=n(a("./node_modules/antd/es/input/index.js"));a("./node_modules/antd/es/select/style/css.js");var y=n(a("./node_modules/antd/es/select/index.js")),v=l(a("./node_modules/react/index.js")),M=(a("./node_modules/antd/es/index.js"),n(a("./src/api/index.js"))),T=(n(a("./src/components/AddProofFileModal/index.js")),a("./node_modules/dva/index.js")),j=n(a("./src/utils/formValidate.js")),N=a("./src/utils/utils.js"),w=(n(a("./src/components/PreviewPictrueModal/index.js")),a("./src/utils/request.js"));function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,l=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(l,arguments,n)}else a=l.apply(this,arguments);return(0,g.default)(this,a)}}var A=v.default.lazy((function(){return Promise.all([a.e(0),a.e(1)]).then(a.t.bind(null,"./src/components/ViewRichTextModal/index.js",7))})),_=y.default.Option,k=E.default.TextArea,O=b.default.confirm,F=function(e){(0,f.default)(a,e);var t=P(a);function a(e){var l;return(0,p.default)(this,a),(l=t.call(this,e)).state={loading:!1,submitParams:{industryType:null,applyAmount:null,applyTerm:null,area:null,comment:null,regPlace:null,regCapital:null,legalName:null,corpContact:null,applicant:null,applicantJob:null,applicantMobile:null,applicantPhone:null,applicantMail:null,isCredit:!1},viewRichTextModal:!1},l.closeViewRichTextModal=function(){l.setState({viewRichTextModal:!1})},l.checkApplyAmount=function(e,t){e&&(/^(0|[1-9][0-9]*)$/.test(e)?e>1e6?c.default.warning("融资金额不得高于100亿"):M.default.enterpriseHome.getCompanyNeedVerify({params:{amount:e}}).then((function(e){e.data.success||O({title:e.data.msg,okText:"是",cancelText:"否",onOk:function(){setTimeout((function(){t&&t()}),0)}})})):c.default.warning("融资金额格式有误，请填写整数"))},l.inputRef=v.default.createRef(),l}return(0,m.default)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,l=t.userStore.userInfo,n=void 0===l?{}:l,r=n.corp,u=void 0===r?{}:r,i=n.user,s=void 0===i?{}:i,d=u.legalName,o=u.phone,c=u.userPhone,p=u.companyEmail,m=u.companyRegisAddr,f=u.companyRegisCap,g=u.region,h=s.userName,b=this.state.submitParams,E=void 0===b?{}:b;!e.visible&&a&&(E.legalName=d,E.corpContact=o,E.applicant=h,E.applicantMobile=c,E.regPlace=m,E.applicantMail=p,E.regCapital=f,E.area=g,this.setState({submitParams:E}))}},{key:"changeFieldValue",value:function(e,t,a){var l,n=this.state.submitParams;"input"===t?l=a.target.value:"select"===t||"inputNumber"===t||"date"===t?l=a:"checkbox"===t&&(l=a.target.checked),n[e]=l,this.setState({submitParams:n})}},{key:"closeModal",value:function(){(0,this.props.closeApplyModal)(),this.setState({addProofFileModal:!1,previewModal:!1,previewUrl:null,qrcodeModalShow:!1,submitParams:{industryType:null,applyAmount:null,applyTerm:null,area:null,comment:null,regPlace:null,regCapital:null,legalName:null,corpContact:null,applicant:null,applicantJob:null,applicantMobile:null,applicantPhone:null,applicantMail:null,isCredit:!1}})}},{key:"submitModal",value:function(){var e=this,t=this.props,a=t.productInfo,l=void 0===a?{}:a,n=t.userStore,r=(t.dispatch,n.userInfo),u=(void 0===r?{}:r).corp,i=void 0===u?{}:u,s=this.state.submitParams,o=s.guaranteeType||l.guaranteeType||"0",p=C(C({},JSON.parse(JSON.stringify(s))),{},{regCapital:(0,N.isEmpty)(s.regCapital)?null:Number(s.regCapital),startTime:(0,N.isEmpty)(s.startTime)?null:s.startTime.format("YYYY-MM-DD"),endTime:(0,N.isEmpty)(s.endTime)?null:s.endTime.format("YYYY-MM-DD"),productId:l.id,applyTime:l.applyTime,guaranteeType:o,industryType:(0,N.isEmpty)(s.industryType)&&i.industryType?i.industryType:s.industryType}),m=[{applyAmount:[{required:!0,message:"请填写承保金额"},{validator:function(e,t,a){/^(0|[1-9][0-9]*)$/.test(t)?t>1e6?a(new Error("承保金额不得高于100亿")):a():a(new Error("承保金额格式有误，请填写整数"))}}],applyTerm:[{required:!0,message:"请填写承保期限"},{validator:function(e,t,a){/^(0|[1-9][0-9]*)$/.test(t)?t>360?a(new Error("承保期限不得大于360个月")):a():a(new Error("承保期限格式有误，请填写整数"))}}],comment:[{required:!0,message:"请填写融资说明"},{validator:function(e,t,a){t&&t.length>200?a(new Error("融资说明不能大于200字符")):a()}}],applicant:[{required:!0,message:"请填写企业联系人姓名"},{validator:function(e,t,a){t&&t.length>50?a(new Error("企业联系人姓名不能大于50字符")):a()}}],applicantJob:[{required:!0,message:"请填写联系人职务"},{validator:function(e,t,a){t&&t.length>100?a(new Error("联系人职务不能大于100字符")):a()}}],applicantMobile:[{required:!0,message:"请填写联系人手机号"},{validator:function(e,t,a){t&&!/^(?:(?:\+|00)86)?1\d{10}$/.test(t)?a(new Error("联系手机号格式有误")):a()}}],applicantPhone:[{validator:function(e,t,a){t&&!/^0\d{2,3}-\d{7,8}$/.test(t)?a(new Error("联系人座机格式有误，0000-00000000")):a()}}],applicantMail:[{validator:function(e,t,a){t&&!/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)?a(new Error("联系人邮箱格式有误")):a()}}],guaranteeType:[{required:!0,message:"请选择反担保方式"}],antiGuaranteeComment:[{validator:function(e,t,a){t&&t.length>200?a(new Error("反担保说明不能大于200字符")):a()}}]},["applyAmount","applyTerm","comment","applicant","applicantJob","applicantMobile","applicantPhone","applicantMail","guaranteeType","antiGuaranteeComment"]];(0,d.default)(j.default,[p].concat(m)).validate((function(t,a){t?p.isCredit?p.applyAmount<l.minimumCoverage?c.default.warn("承保金额不得小于最低承保金额"):p.applyTerm>l.loanLimitMax||p.applyTerm<l.loanLimitMin?c.default.warn("承保期限需在产品的承保期限区间内"):(e.setState({loading:!0}),M.default.enterpriseFinancingProduct.guaranteeApply({data:p}).then((function(t){c.default.success("申请操作成功"),e.closeModal(),e.setState({loading:!1})})).catch((function(t){e.setState({loading:!1})}))):c.default.warn("未同意关于授权查询、采集和使用企业信息的函"):c.default.warning(Object.values(a)[0][0].message)}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.submitParams,l=t.loading,n=a.applyAmount,d=a.applyTerm,o=a.comment,c=a.applicant,p=a.applicantMobile,m=a.applicantJob,f=a.guaranteeType,g=a.isCredit,h=a.applicantPhone,M=a.antiGuaranteeComment,T=a.applicantMail,j=a.area,x=this.props,C=x.visible,P=x.userStore,O=x.globalStore,F=x.productInfo,R=void 0===F?{}:F;console.log(R,"productInfo");var S=O.allMap,q=void 0===S?{}:S,V=P.userInfo,D=void 0===V?{}:V,X=q[113]||[],J=(q[111]||[]).find((function(e){return e.code===j})),z=(0,N.isEmpty)(R.rateMin)||isNaN(R.rateMin)?"-":R.rateMin.toFixed(2),I=(0,N.isEmpty)(R.rateMax)||isNaN(R.rateMax)?"-":R.rateMax.toFixed(2),Y=(0,N.isEmpty)(R.insuranceAmountMin)||isNaN(R.insuranceAmountMin)?"-":R.insuranceAmountMin,Z=(0,N.isEmpty)(R.insuranceAmountMax)||isNaN(R.insuranceAmountMax)?"-":R.insuranceAmountMax;return v.default.createElement(b.default,{title:"保险申请",visible:C,onCancel:function(){e.closeModal()},onOk:function(){e.submitModal()},confirmLoading:l,width:980,okText:"提交"},v.default.createElement("div",{className:"apply-modal"},v.default.createElement("div",{className:"guarantee-info"},"基本信息"),v.default.createElement("div",{className:"basic-form"},v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title"},"企业名称:")),v.default.createElement(s.default,{span:8,style:{paddingTop:6}},D&&D.corp&&D.corp.name?D.corp.name:"-"),v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"行业类型:")),v.default.createElement(s.default,{span:7,style:{marginTop:6}},D.corp&&D.corp.trade||"-")),v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title"},"产品名称:")),v.default.createElement(s.default,{span:8,style:{paddingTop:6}},R.name||"-"),v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"承保金额:")),v.default.createElement(s.default,{span:7},v.default.createElement(E.default,{placeholder:"最低不得小于".concat(R.minimumCoverage,"万"),addonAfter:"万",ref:this.inputRef,value:n||void 0,onBlur:function(t){return e.checkApplyAmount(t.target.value,(function(){e.inputRef.current.focus()}))},onChange:function(t){e.changeFieldValue("applyAmount","input",t)}}))),v.default.createElement(i.default,{gutter:10},"rate"===R.insuranceType?v.default.createElement(v.Fragment,null,v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title"},"承保费率:")),v.default.createElement(s.default,{span:8,style:{paddingTop:6}},"".concat(z,"% ~ ").concat(I,"%"))):v.default.createElement(v.Fragment,null,v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title"},"承保价格:")),v.default.createElement(s.default,{span:8,style:{paddingTop:6}},"".concat(Y,"元 ~ ").concat(Z,"元"))),v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"承保期限:")),v.default.createElement(s.default,{span:7},v.default.createElement(E.default,{placeholder:"".concat(R.loanLimitMin,"-").concat(R.loanLimitMax,"个月"),addonAfter:"月",value:d||void 0,onChange:function(t){e.changeFieldValue("applyTerm","input",t)}}))),v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"地区:")),v.default.createElement(s.default,{span:8,style:{lineHeight:"32px",height:32}},J&&"江西省高安市".concat(J.name))),v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"融资说明:")),v.default.createElement(s.default,{span:19},v.default.createElement(k,{rows:4,placeholder:"请输入你的融资说明",value:o||void 0,onChange:function(t){e.changeFieldValue("comment","input",t)}}))),v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"企业联系人:")),v.default.createElement(s.default,{span:8},v.default.createElement(E.default,{className:"publish-demands-form-content",placeholder:"请输入企业联系人",value:c,onChange:function(t){e.changeFieldValue("applicant","input",t)}})),v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"联系人职务:")),v.default.createElement(s.default,{span:7},v.default.createElement(E.default,{className:"publish-demands-form-content",placeholder:"请输入联系人职务",value:m,onChange:function(t){e.changeFieldValue("applicantJob","input",t)}}))),v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title lable-require"},"联系人手机号:")),v.default.createElement(s.default,{span:8},v.default.createElement(E.default,{className:"publish-demands-form-content",placeholder:"请输入联系人手机号",value:p,onChange:function(t){e.changeFieldValue("applicantMobile","input",t)}})),v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title"},"联系人座机:")),v.default.createElement(s.default,{span:7},v.default.createElement(E.default,{className:"publish-demands-form-content",placeholder:"请输入联系人座机(XXXX-XXXXXXXX)",value:h,onChange:function(t){e.changeFieldValue("applicantPhone","input",t)}}))),v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title"},"联系人邮箱:")),v.default.createElement(s.default,{span:8},v.default.createElement(E.default,{className:"publish-demands-form-content",placeholder:"请输入联系人邮箱",value:T,onChange:function(t){e.changeFieldValue("applicantMail","input",t)}})),v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title"},"申请日期:")),v.default.createElement(s.default,{span:7,style:{paddingTop:6}},R.applyTime||"-"))),v.default.createElement("div",{className:"guarantee-info"},"反担保信息"),v.default.createElement("div",{className:"basic-form"},v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title  lable-require"},"反担保类型:")),v.default.createElement(s.default,{span:8,style:{marginTop:5}},(R.guaranteeType||0===R.guaranteeType)&&X&&(X.find((function(e,t){return e.code==="".concat(R.guaranteeType)}))||{name:"不限"}).name,!R.guaranteeType&&0!==R.guaranteeType&&v.default.createElement(y.default,{onChange:function(t){e.changeFieldValue("guaranteeType","select",t)},placeholder:"请选择反担保类型",value:f||"0"},X&&X.length>0&&X.map((function(e,t){return v.default.createElement(_,{value:e.code,key:t},e.name)}))))),v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"basic-info-title "},"反担保说明:")),v.default.createElement(s.default,{span:19},v.default.createElement(k,{rows:4,placeholder:"请输入你的反担保说明",value:M||void 0,onChange:function(t){e.changeFieldValue("antiGuaranteeComment","input",t)}})))),v.default.createElement("div",{className:"apply-modal-box basic-form"},v.default.createElement(i.default,{gutter:10},v.default.createElement(s.default,{span:11,offset:4},v.default.createElement(u.default,{checked:g,onChange:function(t){e.changeFieldValue("isCredit","checkbox",t),t.target.checked&&e.setState({viewRichTextModal:!0})}}),v.default.createElement(r.default,{title:"点击下载"},v.default.createElement("a",{className:"ml10",onClick:function(){(0,w.downloadFile)("企业授权查询、采集和使用企业信息的函")}},"关于同意授权查询、采集和使用企业信息的函")))))),v.default.createElement(v.Suspense,{fallback:null},v.default.createElement(A,{visible:this.state.viewRichTextModal,closeModal:this.closeViewRichTextModal,section:"企业授权查询、采集和使用企业信息的函"})))}}]),a}(v.Component),R=(0,T.connect)((function(e){return{globalStore:e.global,userStore:e.user}}))(F);t.default=R}}]);